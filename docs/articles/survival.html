<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ClassifyR">
<title>Survival Data Analysis â€¢ ClassifyR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Survival Data Analysis">
<meta property="og:description" content="ClassifyR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ClassifyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.4.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ClassifyR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DevelopersGuide.html">**ClassifyR** Developer's Guide</a>
    <a class="dropdown-item" href="../articles/incorporateNew.html">Creating a Wrapper for New Functionality and Registering It</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to the Concepts of ClassifyR</a>
    <a class="dropdown-item" href="../articles/multiViewMethods.html">Multi-view Methods for Modelling of Multiple Data Views</a>
    <a class="dropdown-item" href="../articles/performanceEvaluation.html">Performance Evaluation of Fitted Models</a>
    <a class="dropdown-item" href="../articles/presets.html">Parameter Tuning Presets for crossValidate and Their Customisation</a>
    <a class="dropdown-item" href="../articles/survival.html">Survival Data Analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Survival Data Analysis</h1>
                        <h4 data-toc-skip class="author">Dario Strbenac
<br> The University of Sydney, Australia.</h4>
            
      
      
      <div class="d-none name"><code>survival.Rmd</code></div>
    </div>

    
    
<p>The modelling of survival data may be done using ClassifyR, not only
categorical data. Currently, feature selection based on Cox proportional
hazards ranking and models built on Cox proportional hazards or random
survival forests are available.</p>
<p>To illustrate, clinical variables of the METABRIC breast cancer
cohort will be used to predict risk scores for patients.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">METABRICclinical</span><span class="op">)</span> <span class="co"># Contains measurements and classes variables.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clinical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 6 rows and 8 columns</span></span>
<span><span class="co">##         Breast.Tumour.Laterality ER.Status Inferred.Menopausal.State</span></span>
<span><span class="co">##                         &lt;factor&gt;  &lt;factor&gt;                  &lt;factor&gt;</span></span>
<span><span class="co">## MB-0002                        r       pos                      pre </span></span>
<span><span class="co">## MB-0005                        r       pos                      pre </span></span>
<span><span class="co">## MB-0010                        l       pos                      post</span></span>
<span><span class="co">## MB-0013                        l       pos                      post</span></span>
<span><span class="co">## MB-0014                        r       pos                      post</span></span>
<span><span class="co">## MB-0018                        l       neg                      post</span></span>
<span><span class="co">##         Lymph.Nodes.Positive     Grade      Size   timeRFS  eventRFS</span></span>
<span><span class="co">##                    &lt;integer&gt; &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt; &lt;integer&gt;</span></span>
<span><span class="co">## MB-0002                    0         3        10      2539         0</span></span>
<span><span class="co">## MB-0005                    1         2        15      4599         1</span></span>
<span><span class="co">## MB-0010                    0         3        31        88         1</span></span>
<span><span class="co">## MB-0013                    2         2        17      3378         0</span></span>
<span><span class="co">## MB-0014                    1         2        10      4930         0</span></span>
<span><span class="co">## MB-0018                    0         3        22      3422         0</span></span></code></pre>
<p>Cross-validation is very similar to the classification scenario,
except that a <code>Surv</code> object or two column names indicating
the time and event (in that order) are to be specified.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survCrossValidated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crossValidate.html">crossValidate</a></span><span class="op">(</span><span class="va">clinical</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timeRFS"</span>, <span class="st">"eventRFS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">survCrossValidated</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class 'ClassifyResult'.</span></span>
<span><span class="co">## Characteristics:</span></span>
<span><span class="co">##        characteristic                    value</span></span>
<span><span class="co">##       Classifier Name                    CoxPH</span></span>
<span><span class="co">##        Selection Name                    CoxPH</span></span>
<span><span class="co">##       multiViewMethod                     none</span></span>
<span><span class="co">##  characteristicsLabel                     none</span></span>
<span><span class="co">##      Cross-validation 20 Permutations, 5 Folds</span></span>
<span><span class="co">## Features: List of length 100 of feature identifiers.</span></span>
<span><span class="co">## Predictions: A data frame of 9400 rows.</span></span>
<span><span class="co">## Performance Measures: None calculated yet.</span></span></code></pre>
<p>By default, Cox proportional hazards has been used for feature
selection as well as modelling.</p>
<p>The distribution of C-index values can be plotted.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/performancePlot.html">performancePlot</a></span><span class="op">(</span><span class="va">survCrossValidated</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .local(results, ...): C-index not found in all elements of results.</span></span>
<span><span class="co">## Calculating it now.</span></span></code></pre>
<p><img src="survival_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The typical C-index is about 0.65, often seen in genomics
analysis.</p>
<p>Now, do no explicit feature selection and use a random survival
forest. This will take substantially longer than Cox proportional
hazards because parameter tuning of the fraction of variables to
consider at each split and the number of trees to build are optimised
over a grid of default values (see <a href="presets.html">Parameter
Tuning Presets</a> article for details).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survForestCrossValidated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crossValidate.html">crossValidate</a></span><span class="op">(</span><span class="va">clinical</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timeRFS"</span>, <span class="st">"eventRFS"</span><span class="op">)</span>,</span>
<span>                                          selectionMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                                          classifier <span class="op">=</span> <span class="st">"randomSurvivalForest"</span>,</span>
<span>                                          nCores <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">resultsList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">survCrossValidated</span>, <span class="va">survForestCrossValidated</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/performancePlot.html">performancePlot</a></span><span class="op">(</span><span class="va">resultsList</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .local(results, ...): C-index not found in all elements of results.</span></span>
<span><span class="co">## Calculating it now.</span></span></code></pre>
<p><img src="survival_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The random survival forest performs better than random chance but not
better than Cox proportional hazards.</p>
<p><strong>Exercise</strong>: Plot the per-sample C-index using
<code>samplesMetricMap(resultsList)</code> to identify patients who are
predicted well and those who are not.</p>
<p>Finally, note that extreme gradient boosting can also fit survival
models. <code>classifier = "XGB"</code> will fit such a model. Remember
that <code>classifier</code> can also be a vector of strings, so all
three models can be fitted in one command.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dario Strbenac, Ellis Patrick, Sourish Iyengar, Harry Robertson, Andy Tran, John Ormerod, Graham Mann, Jean Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
